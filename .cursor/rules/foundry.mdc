---
name: 'Foundry MCP Usage Guide'
description: 'Comprehensive guide for using Foundry MCP tools effectively in AI-assisted development'
alwaysApply: true
---

# Foundry MCP Usage Guide for AI Assistants

## Overview

Foundry MCP is a project management tool designed specifically for AI coding assistants. It provides structured project context, specification management, and workflow guidance through a standardized directory structure in `~/.foundry/`.

**Key Principles:**

- **Content Agnostic**: Foundry manages structure, not content opinions
- **LLM-Driven**: You provide complete content as arguments
- **User-Controlled**: Users control content, CLI manages structure
- **Workflow-Aware**: Tools provide next-steps guidance for efficient development

## Core Concepts

### Project Structure

Each Foundry project contains:

- **`vision.md`**: High-level product vision and goals (200+ characters, you provide)
- **`tech-stack.md`**: Technology decisions and architecture (150+ characters, you provide)
- **`summary.md`**: Concise context for quick LLM consumption (100+ characters, you provide)
- **`specs/`**: Directory containing timestamped feature specifications

### Specification Structure

Each spec contains:

- **`spec.md`**: Detailed feature requirements, acceptance criteria, implementation approach
- **`task-list.md`**: Implementation checklist with checkboxes (- [ ] task, - [x] completed)
- **`notes.md`**: Additional context, design decisions, and implementation notes

## Tool Usage Guidelines

### When to Use Each Tool

#### Project Management

- **`create-project`**: For NEW initiatives requiring full project context

  - When: Starting fresh projects, establishing project foundation
  - You provide: Complete vision, detailed tech-stack, concise summary
  - CLI creates: Project directory structure and validates content

- **`analyze-project`**: For EXISTING codebases you want to manage with Foundry

  - When: Adding Foundry management to projects with existing code
  - Process: First explore codebase, then provide analyzed vision/tech-stack/summary
  - Best for: Documentation, structured management of legacy projects

- **`load-project`**: ALWAYS do this first when working on existing projects
  - When: Starting work sessions, understanding project scope
  - Returns: Project vision, tech-stack, summary, available specs
  - Critical: Never create specs without loading project context first

#### Specification Management

- **`create-spec`**: Breaking down features into detailed implementation plans

  - When: Starting new features or user stories
  - You provide: Feature spec, task breakdown, implementation notes
  - Creates: Timestamped directory (YYYYMMDD_HHMMSS_feature_name)

- **`load-spec`**: Reviewing specifications and checking progress

  - When: Continuing work on existing features, checking task status
  - Returns: Complete spec content with project context

- **`update-spec`**: Updating multiple spec files in a single operation with explicit content replacement control

  - **File Types**: `spec` (spec.md), `tasks` (task-list.md), `notes` (notes.md)
  - **Operations**: `replace` (overwrite) or `append` (add to existing) - REQUIRED
  - **Usage**:

    ```bash
    # Update single file
    foundry mcp update-spec <project> <spec> --spec "<content>" --operation <replace|append>

    # Update multiple files in one command
    foundry mcp update-spec <project> <spec> \
      --spec "<spec content>" \
      --tasks "<task content>" \
      --notes "<notes content>" \
      --operation <replace|append>
    ```

  - **Operation Types**:
    - **`--operation replace`**: Completely replaces file content with new content
      - **Use when**: Major changes, complete rewrites, replacing outdated content
      - **Risk**: Existing content is permanently lost
    - **`--operation append`**: Adds new content to the end of existing content
      - **Use when**: Iterative development, adding tasks/notes, preserving history
      - **Risk**: Low - existing content is preserved
  - **Best Practices**:
    - Use `append` for iterative development: Add new tasks, mark items complete, accumulate notes
    - Use `replace` for major changes: Complete rewrites, major requirement changes
    - At least one content parameter (`--spec`, `--tasks`, or `--notes`) must be provided
    - Operation is always required and applies to all files being updated

#### Discovery & Validation

- **`list-projects`**: Discovering available projects

  - When: Finding project names, checking what exists
  - Returns: Project names, creation dates, spec counts

- **`validate-content`**: Checking content before creating projects/specs

  - When: Ensuring content meets length/format requirements
  - Use this proactively to avoid validation errors

- **`get-foundry-help`**: Getting workflow guidance and examples
  - Topics: `workflows`, `content-examples`, `project-structure`, `parameter-guidance`
  - Use when: Understanding best practices, troubleshooting

## Content Requirements & Boundaries

### What You MUST Provide

**Always include these in your arguments:**

- **Vision** (200+ chars): Problem statement, target users, value proposition, roadmap priorities
- **Tech Stack** (150+ chars): Languages, frameworks, databases, deployment, rationale
- **Summary** (100+ chars): 2-3 sentences capturing project essence
- **Specifications**: Requirements, acceptance criteria, implementation approach, dependencies
- **Task Lists**: Specific, actionable implementation steps with checkboxes
- **Notes**: Design decisions, context, implementation details

### What CLI Handles

**Never include these in content:**

- File structure and organization
- Content validation (length, format only)
- Directory creation and timestamps
- Project/spec naming conventions
- Error handling and recovery suggestions

### Content Formatting Guidelines

#### Vision (vision.md)

```markdown
## Problem Statement

[Describe the problem being solved]

## Target Users

[Who benefits from this solution]

## Value Proposition

[Unique advantages and competitive edge]

## Key Features & Roadmap

[Main capabilities and development priorities]
```

#### Tech Stack (tech-stack.md)

```markdown
## Backend

- **Language**: [choice] - [rationale]
- **Framework**: [choice] - [why this framework]

## Database

- **Type**: [choice] - [use case fit]

## Deployment

- **Platform**: [choice] - [scaling/scalability needs]
```

#### Specifications (spec.md)

```markdown
# Feature Name

## Overview

[Purpose and scope]

## Requirements

- [Functional requirements]
- [Non-functional requirements]

## Acceptance Criteria

- [ ] Criterion 1
- [ ] Criterion 2

## Implementation Approach

[Technical strategy, architecture decisions]

## Dependencies

[What this feature depends on]
```

#### Task Lists (task-list.md)

```markdown
- [ ] Implement user authentication system
- [ ] Add password hashing and validation
- [ ] Create user registration endpoint
- [ ] Add login/logout functionality
- [ ] Implement session management
```

## Best Practices & Workflow Patterns

### 1. Always Load Context First

```bash
# ✅ Good: Load project context before working
foundry mcp load-project my-project
foundry mcp create-spec my-project new-feature

# ❌ Avoid: Creating specs without context
foundry mcp create-spec my-project new-feature
```

### 2. Use Iterative Development

```bash
# Create initial spec
foundry mcp create-spec my-project user-auth

# Update task progress during development
foundry mcp update-spec my-project 20240101_user_auth --tasks "- [x] Completed password validation" --operation append

# Add implementation notes
foundry mcp update-spec my-project 20240101_user_auth --notes "## Implementation Notes\nUsed bcrypt for password hashing with 12 rounds for security." --operation append

# Update both tasks and notes in one command
foundry mcp update-spec my-project 20240101_user_auth \
  --tasks "- [x] Completed authentication module" \
  --notes "Added JWT token validation with 12-round bcrypt" \
  --operation append
```

### 3. Follow Next Steps Guidance

- Every Foundry command returns `next_steps` and `workflow_hints`
- Follow these suggestions for efficient development
- Use `get-foundry-help workflows` for additional guidance

### 4. Validate Content Proactively

```bash
# Check content before creating
foundry mcp validate-content vision --content "Your vision content here"
foundry mcp validate-content spec --content "Your spec content here"
```

### 5. Use Appropriate Spec Granularity

- **One spec per feature/story**: Don't create monolithic specs
- **Use task-list.md**: Break features into actionable implementation steps
- **Use notes.md**: Document design decisions and rationale
- **Update regularly**: Use append operations to track progress

## Common Workflows

### New Project Setup

1. **Create Project**: `foundry mcp create-project my-app --vision "..." --tech-stack "..." --summary "..."`
2. **Create First Spec**: `foundry mcp create-spec my-app user-auth --spec "..." --tasks "..." --notes "..."`
3. **Follow next_steps** for iterative development

### Feature Development Cycle

1. **Load Project**: `foundry mcp load-project my-app` (get context)
2. **Create Spec**: `foundry mcp create-spec my-app payment-integration`
3. **Update Progress**: Use `update-spec` with `append` to mark tasks complete
4. **Add Notes**: Document implementation decisions and challenges
5. **Load Spec**: Review progress and get workflow guidance

### Existing Codebase Analysis

1. **Explore Codebase**: Use Search, Grep, Read tools to understand structure
2. **Analyze Project**: `foundry mcp analyze-project analyzed-app --vision "..." --tech-stack "..." --summary "..."`
3. **Create Specs**: Add feature development plans within analyzed project

### Context Loading for Conversations

1. **Quick Context**: Load project summary for high-level understanding
2. **Detailed Context**: Load specific specs for implementation work
3. **Full Context**: Load entire project when starting comprehensive work

## Error Handling & Troubleshooting

### Content Validation Errors

- **"Content too short"**: Provide more detailed content (vision: 200+, tech-stack: 150+, summary: 100+)
- **"Content validation failed"**: Use `validate-content` to check before creating
- **Solution**: Expand content with more specific details and examples

### Project/Spec Not Found

- **"Project not found"**: Use `list-projects` to see available projects
- **"Spec not found"**: Load project first to see available specs
- **Solution**: Always load project context before working with specs

### File Operation Errors

- **Permission denied**: May need to run with appropriate permissions
- **File locked**: Close files in other applications
- **Solution**: Check file permissions and close conflicting applications

### MCP vs CLI Tool Confusion

- **MCP Tools**: Available through AI assistant interface (all core Foundry functionality)
- **CLI Tools**: Use terminal/command line (delete-spec, install/uninstall/status commands)
- **Most tools work through both interfaces**: create-project, update-spec, load-project, etc.
- **When to use CLI**: For installation management, status checking, deletion operations

## Tips for Effective Usage

1. **Start with Context**: Always load project before creating specs
2. **Use Append for Updates**: Build up task lists and notes incrementally
3. **Follow Guidance**: Pay attention to next_steps and workflow_hints
4. **Validate First**: Use validate-content to avoid rejection
5. **Keep Specs Focused**: One feature per spec, use task-list for breakdown
6. **Document Decisions**: Use notes.md for rationale and context
7. **Update Regularly**: Mark tasks complete, add implementation notes
8. **Get Help**: Use get-foundry-help for workflow guidance

## Quick Reference

### Most Common Commands

```bash
# Start working on existing project
foundry mcp load-project my-project

# Create new feature spec
foundry mcp create-spec my-project user-auth

# Update task progress
foundry mcp update-spec my-project 20240101_user_auth --tasks "- [x] Completed implementation" --operation append

# Update multiple files at once
foundry mcp update-spec my-project 20240101_user_auth \
  --tasks "- [x] New task completed" \
  --notes "Implementation details added" \
  --operation append

# Get help
foundry mcp get-foundry-help workflows
```

### Content Length Requirements

- **Vision**: 200+ characters (2-4 paragraphs with examples)
- **Tech Stack**: 150+ characters (detailed technology choices with rationale)
- **Summary**: 100+ characters (2-3 sentences capturing essence)
- **Specifications**: Comprehensive but focused on requirements and approach
- **Task Lists**: Specific, actionable implementation steps
- **Notes**: Design decisions, context, implementation details

Remember: Foundry manages structure, you provide content. Focus on comprehensive, well-structured content that helps future development.
